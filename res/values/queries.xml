<resources>
	<string name="query_properties"><![CDATA["
		select
			p._id,
			p.name,
			p.image,
			pt.image as typeImage,
			(select count(1) from Room where property = p._id) as childrenCount
		from Property p
		join PropertyType pt ON p.type = pt._id
		order by p.name asc
	"]]></string>
	<string name="query_property"><![CDATA["
		select p._id, p.name, p.type, p.image, pt.image as typeImage
		from Property p
		join PropertyType pt ON p.type = pt._id
		where p._id = ?
	"]]></string>
	<string name="query_property_new"><![CDATA["
		insert into Property(name, type, image) values(?, ?, ?)
	"]]></string>
	<string name="query_property_update"><![CDATA["
		update Property set name = ?, type = ?, image = ? where _id = ?
	"]]></string>
	<string name="query_property_delete"><![CDATA["
		delete from Property where _id = ?
	"]]></string>
	<string name="query_property_delete_rooms"><![CDATA["
		delete from Room where property = ?
	"]]></string>
	<string name="query_property_types"><![CDATA["
		select _id, name
		from PropertyType
		order by priority
	"]]></string>
	<string name="query_property_types_filtered"><![CDATA["
		select _id, name
		from PropertyType
		where name like ? escape '\'
		order by priority
	"]]></string>
	<string name="query_room_types"><![CDATA["
		select _id, name
		from RoomType
		order by priority
	"]]></string>
	<string name="query_rooms"><![CDATA["
		select
			r._id,
			r.root,
			r.name,
			r.image,
			COALESCE(rt.image, rtk.image) as typeImage,
			(select count(1) from Item where parent = r.root) as childrenCount
		from Room r
		join RoomType rt ON r.type = rt._id
		join RoomTypeKind rtk ON rt.kind = rtk._id
		where r.property = ?
		order by r.name asc 
	"]]></string>
	<string name="query_room"><![CDATA["
		select r._id, r.name, r.type, r.root, r.property, r.image, COALESCE(rt.image, rtk.image) as typeImage
		from Room r
		join RoomType rt ON r.type = rt._id
		join RoomTypeKind rtk ON rt.kind = rtk._id
		where r._id = ?
	"]]></string>
	<string name="query_room_new"><![CDATA["
		insert into Room(property, root, name, type, image) values(?, ?, ?, ?, ?)
	"]]></string>
	<string name="query_room_update"><![CDATA["
		update Room set name = ?, type = ?, image = ? where _id = ?
	"]]></string>
	<string name="query_room_delete"><![CDATA["
		delete from Room where _id = ?
	"]]></string>
	<string name="query_item_categories"><![CDATA["
		select
			c._id,
			c.name,
			c.parent,
			cd.level,
			'category_unknown' as image
		from Category_Descendant cd
		join Category c ON cd.descendant = c._id and c._id >= 0
		where cd.category = ?
	"]]></string>
	<string name="query_items"><![CDATA["
		select
			i._id,
			i.name,
			i.image,
			'category_unknown' as typeImage,
			(select count(1) from Item where parent = i._id) as childrenCount,
			c.name as category
		from Item     i
		join Category c ON i.category = c._id
		where i.parent = ?
		order by i.name asc 
	"]]></string>
	<string name="query_items_by_category"><![CDATA["
		select
			i._id,
			i.name,
			i.image,
			'category_unknown' as typeImage,
			(select count(1) from Item where parent = i._id) as childrenCount,
			c.name as category
		from Item     i
		join Category c ON i.category = c._id
		where i.category = ?
		order by i.name asc 
	"]]></string>
	<string name="query_items_in_category"><![CDATA["
		select
			i._id,
			i.name,
			i.image,
			'category_unknown' as typeImage,
			(select count(1) from Item where parent = i._id) as childrenCount,
			c.name as category
		from Item     i
		join Category_Descendant cd ON i.category = cd.descendant
		join Category c ON cd.descendant = c._id
		where cd.category = ?
		order by i.name asc 
	"]]></string>
	<string name="query_item"><![CDATA["
		select i._id, i.name, i.category, i.image, 'category_unknown' as typeImage
		from Item i
		where i._id = ?
	"]]></string>
	<string name="query_categories"><![CDATA["
		select
			c._id,
			c.name,
			'category_unknown' as image,
			(select count(1) from Category where parent = c._id) as childrenCount,
			(select count(1) from Item where category in (select descendant from Category_Descendant where category = c._id)) as countItems
		from Category c
		where c.parent = ?
		order by c.name asc
	"]]></string>
	<string name="query_category"><![CDATA["
		select c._id, c.name, 'category_unknown' as typeImage, NULL as image
		from Category c
		where c._id = ?
	"]]></string>
	<string name="query_item_new"><![CDATA["
		insert into Item(parent, name, category, image) values(?, ?, ?, ?)
	"]]></string>
	<string name="query_item_update"><![CDATA["
		update Item set name = ?, category = ?, image = ? where _id = ?
	"]]></string>
	<string name="query_item_delete"><![CDATA["
		delete from Item where _id = ?
	"]]></string>
	<string name="query_path_new"><![CDATA["
		insert into Paths
	"]]></string>
	<string name="query_path_delete"><![CDATA["
		delete from Paths where _id = ?
	"]]></string>
	<string name="query_path_category"><![CDATA["
		insert into Path select p._id, -1, c._id, c.parent from Path p, Category c where p._id = ? and c._id = ?;
	"]]></string>
</resources>
